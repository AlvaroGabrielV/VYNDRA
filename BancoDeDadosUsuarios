CREATE DATABASE IF NOT EXISTS TCC
DEFAULT CHARACTER SET UTF8MB4
DEFAULT COLLATE UTF8MB4_UNICODE_CI;

USE TCC;

CREATE TABLE usuarios(
	 id_usuario INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nomeexibicao VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    usuario VARCHAR(100) NOT NULL UNIQUE,
    senha VARCHAR(255) NOT NULL,
    datanascimento DATE not NULL,
    telefone VARCHAR(20) NULL,
	 datacadastro DATETIME DEFAULT CURRENT_TIMESTAMP,
	 fotoperfil LONGBLOB,
	 instagram VARCHAR(30) DEFAULT 'A fazer...',
	 linkedin VARCHAR(30)  DEFAULT 'A fazer...'
) DEFAULT CHARSET = UTF8MB4
  DEFAULT COLLATE = UTF8MB4_UNICODE_CI;

CREATE TABLE IF NOT EXISTS codigos_recuperacao (
    id_codigo INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    id_usuario INT NOT NULL,
    codigo VARCHAR(10) NOT NULL,
    criado_em DATETIME DEFAULT CURRENT_TIMESTAMP,
    expiracao DATETIME NOT NULL,
    usado BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (id_usuario) REFERENCES usuarios(id) ON DELETE CASCADE
) DEFAULT CHARSET = UTF8MB4
  DEFAULT COLLATE = UTF8MB4_UNICODE_CI;
  
CREATE TABLE IF NOT EXISTS relatorios (
	  id_relatorio INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	  id_usuario INT NOT NULL,
	  titulo VARCHAR(30) NOT NULL,
	  descricao TEXT,
	  datacriacao DATETIME DEFAULT NOW(),
	  FOREIGN KEY (id_usuario) REFERENCES usuarios(id) ON DELETE CASCADE	
)DEFAULT CHARSET = UTF8MB4
 DEFAULT COLLATE = UTF8MB4_UNICODE_CI;


